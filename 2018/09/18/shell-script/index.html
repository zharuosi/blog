<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/blog/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/blog/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  
    
      
    

    
  

  

  

  
    
    
    <link href="fonts.google.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Ubuntu:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Linux," />










<meta name="description" content="Introduction Shell scripting makes life more comfortable. The command sequences of Linux can be combined in one shell script and be executed automatically without wasting any time. For example, if yo">
<meta name="keywords" content="Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="Writing shell scripts">
<meta property="og:url" content="https://zharuosi.github.io/blog/2018/09/18/shell-script/index.html">
<meta property="og:site_name" content="Of Course I Still Love You">
<meta property="og:description" content="Introduction Shell scripting makes life more comfortable. The command sequences of Linux can be combined in one shell script and be executed automatically without wasting any time. For example, if yo">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-09-25T01:03:10.478Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Writing shell scripts">
<meta name="twitter:description" content="Introduction Shell scripting makes life more comfortable. The command sequences of Linux can be combined in one shell script and be executed automatically without wasting any time. For example, if yo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zharuosi.github.io/blog/2018/09/18/shell-script/"/>





  <title>Writing shell scripts | Of Course I Still Love You</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="site-title">Of Course I Still Love You</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/blog/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet">

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zharuosi.github.io/blog/blog/2018/09/18/shell-script/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ruosi Zha">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Of Course I Still Love You">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Writing shell scripts</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-18T23:57:02-02:30">
                2018-09-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/吴带当风/" itemprop="url" rel="index">
                    <span itemprop="name">吴带当风</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 阅读
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2>
<p>Shell scripting makes life more comfortable. The command sequences of Linux can be combined in one shell script and be executed automatically without wasting any time. For example, if you would like to rename 9,999,999 files and put them into different directories during one week, clicking the mouse will be devastating. By shell scripting, all you need is to run one command in a loop. After that, you can have a vacation and enjoy coffee in the next seven days.</p>
<p>Suppose we have known at least a little bit about Linux. What is a Linux shell? Shell is an command language interpreter that executes commands. The most commonly used shells are SH (Bourne SHell) and Bash (Bourne again shell), released in 1989. Bash is not a perfect scripting language, but it is very useful. Life is short, get rid of the mouse.</p>
<a id="more"></a>
<h2 id="shell-scripting-basics"><a class="markdownIt-Anchor" href="#shell-scripting-basics"></a> Shell Scripting Basics</h2>
<p>Here are some examples and templates of the shell scripting to take care of the files and directories.</p>
<figure class="highlight shell"><figcaption><span>shell</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> reading the content of file1 and the output is written to file2 (instead of being displayed on screen)</span></span><br><span class="line">cat file1 &gt; file2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> reading the content of file1 and the output is added to the end of file2</span></span><br><span class="line">cat file1 &gt;&gt; file2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> concatenation and alphabetize (from a to z or from 1 to infinite) the lines of text after concatenation</span></span><br><span class="line">cat file1 file2 file3 | sort &gt; file4</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> deleting a directory excluding files (no <span class="string">"-r"</span>)</span></span><br><span class="line">rmdir directory</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> unpack</span></span><br><span class="line">tar -zxvf file.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> pack directories or files to a file archiver</span></span><br><span class="line">tar -zcvf test.tar.gz directory file1 file2...</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> search a file name <span class="keyword">in</span> a directory</span></span><br><span class="line">find ~/ -name "*.sh"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> search <span class="keyword">for</span> a certain text within files and show the line number</span></span><br><span class="line">grep "money*" filename -n</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> search <span class="keyword">for</span> a special file without a character, e.g. we have a@0.sim, a@1.sim, a.sim</span></span><br><span class="line">ls ./*.sim | grep -v @</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> displaying all currently running processes (-f is equal to -A) / show details / certain process / by certain user</span></span><br><span class="line">ps -A</span><br><span class="line">ps -aux</span><br><span class="line">ps -ef | grep "firefox"</span><br><span class="line">ps -u root</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> conditional statement used to examine a status of a file</span></span><br><span class="line">if [ ! -f "$myFile" ]; then</span><br><span class="line">touch "$myFile"</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> -a file 	Returns <span class="literal">true</span> <span class="keyword">if</span> file exists (or -e)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -d file 	Returns <span class="literal">true</span> <span class="keyword">if</span> file exists and is a directory</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -s file 	Returns <span class="literal">true</span> <span class="keyword">if</span> file exists and has a greater size that zero</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -r file 	Returns <span class="literal">true</span> <span class="keyword">if</span> file exists and is readable</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -w file 	Returns <span class="literal">true</span> <span class="keyword">if</span> file exists and is writable</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -x file 	Returns <span class="literal">true</span> <span class="keyword">if</span> file exists and is executable</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -N file 	Returns <span class="literal">true</span> <span class="keyword">if</span> the file exists and has been modified since it was last <span class="built_in">read</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> change file name using sed</span></span><br><span class="line">for file in `ls *.eps`</span><br><span class="line">do </span><br><span class="line">    mv $file `echo $file | sed 's/old/new/g'`</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="file-handling-primer"><a class="markdownIt-Anchor" href="#file-handling-primer"></a> File Handling Primer</h2>
<p>Note that “{” with a hashtag '#&quot; will be a bug for Markdown editor. In the following code, a space is added before the hash. Please delete the space when running the code.</p>
<h3 id="example-1-delete-replace-grep"><a class="markdownIt-Anchor" href="#example-1-delete-replace-grep"></a> Example 1: delete, replace, grep…</h3>
<figure class="highlight shell"><figcaption><span>shell</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is a script to <span class="built_in">read</span> the pressure information from a large amount of <span class="built_in">log</span> files and write the results.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">----------------------------------------<span class="comment">#</span></span></span><br><span class="line"></span><br><span class="line">echo '--&gt; Start reading the minimum pressure and its location: (x,y)'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> get the geometry name:</span></span><br><span class="line">var=./*.IGS</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> add .IGS means to ignore the file <span class="built_in">type</span></span></span><br><span class="line">region_name=$(basename $var .IGS)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'#*-'</span> means delete the left side from the first left <span class="string">'-'</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'##*-'</span> means delete the left side from the last left <span class="string">'-'</span></span></span><br><span class="line">case_name_temp=$&#123;region_name#*-&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> // means replacing all, / means replacing the first element, the second / is a separator</span></span><br><span class="line">case_name=$&#123;case_name_temp//-/_&#125;"_steady@15000.sim"</span><br><span class="line"></span><br><span class="line">log_name="minimum_pressure_log_"$&#123;region_name&#125;".log"</span><br><span class="line"></span><br><span class="line">echo '--&gt; The geometry in this case is named as:' $region_name</span><br><span class="line">echo '--&gt; The case name using the latest .sim file is:' $case_name</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> use <span class="string">" instead of ' to get the variable in shell</span></span></span><br><span class="line">sed -i "s/geometry/$region_name/g" Test_Minimum_Pressure_Location.java</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> note that ` is not <span class="string">'</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> search <span class="keyword">for</span> the first line containing <span class="string">"Total:"</span> <span class="keyword">in</span> the <span class="built_in">log</span> file</span></span><br><span class="line">minimum_cp_temp=`grep "Total:" $log_name | grep -n "" | grep "^1"` </span><br><span class="line"><span class="meta">#</span><span class="bash"> delete the left side from the last left space character</span></span><br><span class="line">minimum_cp_origin=$&#123;minimum_cp_temp##* &#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> transfer the data from .12345678 to 0.12345678</span></span><br><span class="line">minimum_cp=`echo $minimum_cp_origin | awk '&#123;printf("%.8f\n",$0)&#125;'`  </span><br><span class="line"></span><br><span class="line">echo 'minimum_cp is:' $minimum_cp</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> search <span class="keyword">for</span> the second line containing <span class="string">"Total:"</span> <span class="keyword">in</span> the <span class="built_in">log</span> file</span></span><br><span class="line">x_minimum_cp_temp=`grep "Total:" $log_name | grep -n "" | grep "^2"` </span><br><span class="line">x_minimum_cp_origin=$&#123;x_minimum_cp_temp##* &#125;</span><br><span class="line">x_minimum_cp=`echo $x_minimum_cp_origin | awk '&#123;printf("%.9f\n",$0)&#125;'`</span><br><span class="line"></span><br><span class="line">echo 'x_mp is:' $x_minimum_cp</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> search <span class="keyword">for</span> the third line containing <span class="string">"Total:"</span> <span class="keyword">in</span> the <span class="built_in">log</span> file</span></span><br><span class="line">y_minimum_cp_temp=`grep "Total:" $log_name | grep -n "" | grep "^3"` </span><br><span class="line">y_minimum_cp_origin=$&#123;y_minimum_cp_temp##* &#125;</span><br><span class="line">y_minimum_cp=`echo $y_minimum_cp_origin | awk '&#123;printf("%.9f\n",$0)&#125;'`</span><br><span class="line"></span><br><span class="line">echo 'y_mp is:' $y_minimum_cp</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> note: &gt; means replace the old file, &gt;&gt; will add the old file</span></span><br><span class="line">echo 'minimum_cp x_mp y_mp' &gt;&gt; result_minimum_pressure_location.dat</span><br><span class="line">echo "$minimum_cp $x_minimum_cp $y_minimum_cp" &gt;&gt; result_minimum_pressure_location.dat</span><br></pre></td></tr></table></figure>
<h3 id="example-2-array-loop"><a class="markdownIt-Anchor" href="#example-2-array-loop"></a> Example 2: array, loop…</h3>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This is a job submitting script on the cluster of Skipper</span></span><br><span class="line"><span class="comment"># The array can be used only in bash, not in sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get the subdirectory and ignoring the files</span></span><br><span class="line">sub_directory=`ls -l | egrep <span class="string">'^d'</span> | awk <span class="string">'&#123;print $(NF)&#125;'</span>`</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'The directories of the angle of attack are:'</span> <span class="variable">$sub_directory</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get the avaliable node_info of skipper</span></span><br><span class="line">node_number=(26 27 28 22 23)</span><br><span class="line">core_number=(52 52 52 28 28)</span><br><span class="line"></span><br><span class="line"><span class="comment"># index is from 0 to N-1 of all cases</span></span><br><span class="line">index=0</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> allangle <span class="keyword">in</span> <span class="variable">$sub_directory</span> </span><br><span class="line"></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># arrange the node and cores of skipper </span></span><br><span class="line">    <span class="comment"># $[] means arithmetic computation: index%5 loop</span></span><br><span class="line">    <span class="comment"># $&#123;node_number[@]&#125; returns the element of array</span></span><br><span class="line">    <span class="comment"># $&#123; #node_number[@]&#125; returns the element number of array</span></span><br><span class="line"></span><br><span class="line">    i=$[index%<span class="variable">$&#123; #node_number[@]&#125;</span>]</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="comment"># example: cd ./P4.00/</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="variable">$allangle</span></span><br><span class="line"></span><br><span class="line">  node_info=<span class="string">"nodes=compute-0-"</span><span class="variable">$&#123;node_number[$i]&#125;</span><span class="string">":ppn="</span><span class="variable">$&#123;core_number[$i]&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># the present directory</span></span><br><span class="line">  directory_name=`<span class="built_in">pwd</span>`</span><br><span class="line"></span><br><span class="line">  <span class="comment"># get the geometry name, case name, job name and log name </span></span><br><span class="line">  csv_name=./*.csv</span><br><span class="line"></span><br><span class="line">  geometry_name=$(basename <span class="variable">$csv_name</span> .csv)</span><br><span class="line"></span><br><span class="line">  case_name=<span class="string">"steady_"</span><span class="variable">$&#123;geometry_name&#125;</span><span class="string">".sim"</span></span><br><span class="line"></span><br><span class="line">  submit_job_name=<span class="string">"job_"</span><span class="variable">$&#123;geometry_name&#125;</span><span class="string">".sh"</span></span><br><span class="line"></span><br><span class="line">  log_name=<span class="string">"logfile_"</span><span class="variable">$&#123;geometry_name&#125;</span><span class="string">".log"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># configure the job script</span></span><br><span class="line"></span><br><span class="line">  cp ../submit_job_template_skipper.sh ./<span class="variable">$submit_job_name</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># the directory name has the symbol "/", so we use "#" as the separator in sed command</span></span><br><span class="line">  sed -i <span class="string">"s#arg_case_directory#<span class="variable">$directory_name</span>#g"</span> ./<span class="variable">$submit_job_name</span> </span><br><span class="line">  sed -i <span class="string">"s/arg_node_info/<span class="variable">$node_info</span>/g"</span> ./<span class="variable">$submit_job_name</span> </span><br><span class="line">  sed -i <span class="string">"s/arg_case_name/<span class="variable">$case_name</span>/g"</span> ./<span class="variable">$submit_job_name</span> </span><br><span class="line">  sed -i <span class="string">"s/arg_log_name/<span class="variable">$log_name</span>/g"</span> ./<span class="variable">$submit_job_name</span> </span><br><span class="line"></span><br><span class="line">  <span class="comment"># configure the StarCCM+ script</span></span><br><span class="line">  cp ../autorun_naca66mod.java ./</span><br><span class="line"></span><br><span class="line">  sed -i <span class="string">"s/arg_geometry_name/<span class="variable">$geometry_name</span>/g"</span> ./autorun_naca66mod.java</span><br><span class="line">  sed -i <span class="string">"s#arg_case_directory#<span class="variable">$directory_name</span>#g"</span> ./autorun_naca66mod.java</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"--&gt; Present case is: <span class="variable">$case_name</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"--&gt; Present directory is: <span class="variable">$directory_name</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"--&gt; Present computation is on the node: <span class="variable">$node_info</span>"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># qsub $submit_job_name</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"--&gt; Present case is submitted!"</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">cd</span> ../</span><br><span class="line"></span><br><span class="line">  <span class="comment"># update the index of the node array</span></span><br><span class="line">  <span class="comment"># many ways to calculate i++: let i+=1; ((i++)); i=`expr $i + 1`; i=$(( $i + 1 )); i=$[i+1]</span></span><br><span class="line">  index=$[index+1]</span><br><span class="line"></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="run-a-shell-script"><a class="markdownIt-Anchor" href="#run-a-shell-script"></a> Run a Shell Script</h2>
<p>Set the execute permission on your script:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod u+x yourname.sh</span><br><span class="line">./yourname.sh</span><br></pre></td></tr></table></figure>
<p>Enjoy it.</p>
<h2 id="advanced-shell-script"><a class="markdownIt-Anchor" href="#advanced-shell-script"></a> Advanced Shell Script</h2>
<h3 id="remove-all-filesdirectories-except-for-one-file"><a class="markdownIt-Anchor" href="#remove-all-filesdirectories-except-for-one-file"></a> Remove all files/directories except for one file</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> remove files except <span class="string">'file.txt'</span></span></span><br><span class="line">find . ! -name 'file.txt' -type f -exec rm -f &#123;&#125; +</span><br><span class="line"><span class="meta">#</span><span class="bash"> remove directories except <span class="string">'test'</span></span></span><br><span class="line">find . ! -name 'test' -type d -exec rm -rf &#123;&#125; +</span><br></pre></td></tr></table></figure>
<p>In zsh, you must enable extendedglob</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setopt extendedglob &amp;&amp; rm -- ^file.txt</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Reward</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/blog/images/wechatTipCode.jpg" alt="Ruosi Zha WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2018/09/01/elision-pronunciation/" rel="next" title="Elision in Engilish pronunciation">
                <i class="fa fa-chevron-left"></i> Elision in Engilish pronunciation
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2018/10/09/CL-HMS-Belfast/" rel="prev" title="贝尔法斯特的故事">
                贝尔法斯特的故事 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>


  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/blog/images/avatar.gif"
                alt="Ruosi Zha" />
            
              <p class="site-author-name" itemprop="name">Ruosi Zha</p>
              <p class="site-description motion-element" itemprop="description">Consistent Stable Convergent</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#introduction"><span class="nav-number">1.</span> <span class="nav-text"> Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-scripting-basics"><span class="nav-number">2.</span> <span class="nav-text"> Shell Scripting Basics</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#file-handling-primer"><span class="nav-number">3.</span> <span class="nav-text"> File Handling Primer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#example-1-delete-replace-grep"><span class="nav-number">3.1.</span> <span class="nav-text"> Example 1: delete, replace, grep…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#example-2-array-loop"><span class="nav-number">3.2.</span> <span class="nav-text"> Example 2: array, loop…</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#run-a-shell-script"><span class="nav-number">4.</span> <span class="nav-text"> Run a Shell Script</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#advanced-shell-script"><span class="nav-number">5.</span> <span class="nav-text"> Advanced Shell Script</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#remove-all-filesdirectories-except-for-one-file"><span class="nav-number">5.1.</span> <span class="nav-text"> Remove all files/directories except for one file</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    

    </div>
  </aside>



        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ruosi Zha</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>









<span class="post-count">Live long and prosper.</span>

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/blog/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  


  <!--  --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>

